#include "dz60.h"

/******************************************************
*                   Tap Dance
******************************************************/
    enum tap_dance_id {
        TD_GRV_ESC = 0,
    };

    /*
    void q_dance( qk_tap_dance_state_t* state, void* user_data )
    {
        switch ( state->count )
        {
            case 1:
            {
                register_code( KC_Q );
                unregister_code( KC_Q );
                break;
            }
            case 2:
            {
                register_code( KC_ESC );
                unregister_code( KC_ESC );
                break;
            }
            case 3:
            {
                register_code( KC_LSFT );
                register_code( KC_Q );
                unregister_code( KC_Q );
                unregister_code( KC_LSFT );
                break;
            }
        }
        reset_tap_dance( state );
    }
    */

    /* qk_tap_dance_action_t tap_dance_actions[] = { */
      /* [ TD_GRV_ESC ]  = ACTION_TAP_DANCE_DOUBLE( KC_GRV, KC_ESC ) */
    /* }; */

/******************************************************
*                   Functions
******************************************************/
    enum function_id {
        SOLID_RGB
    };

    const uint16_t PROGMEM fn_actions[] = {
        [0]  = ACTION_FUNCTION( SOLID_RGB ),
    };

    void action_function( keyrecord_t *record, uint8_t id, uint8_t opt )
    {
        switch ( id )
        {
            case SOLID_RGB:
            {
                rgblight_mode( 1 );
            }
        }
    }

/******************************************************
*                      ADVANCED
******************************************************/
    const macro_t *action_get_macro( keyrecord_t *record, uint8_t id, uint8_t opt ) {
        switch ( id )
        { }
        return MACRO_NONE;
    }

    bool process_record_user( uint16_t keycode, keyrecord_t *record ) {
        return true;
    }

    void led_set_user(uint8_t usb_led) {
        uint8_t led_num = 2;
        if ( usb_led & ( 1 << USB_LED_CAPS_LOCK ) )
        {
            backlight_set( CAPS_BL_LEVEL );
            DDRB |= ( 1 << led_num );
            PORTB &= ~( 1 << led_num );
        }
        else
        {
            backlight_set( 0 );
            DDRB &= ~( 1 << led_num );
            PORTB &= ~( 1 << led_num );
        }
    }

/******************************************************
*                   Modifier Keys
******************************************************/
    #define MT_SFT_ESC MT( MOD_LSFT, KC_ESC )
    #define CAPS MT( MOD_LCTL, KC_CAPS )
    #define LSHFT MT( MOD_LSFT, KC_ESC )
    #define RSHFT MT( MOD_RSFT, KC_SLSH )
    #define LTSPC LT( 1, KC_BSPC )
    #define MDSPC LT( 2, KC_ESC )
    #define RTSPC LT( 3, KC_SPC )
    #define TAB LT( 4, KC_TAB )

/******************************************************
*                      KEYMAPS
******************************************************/
    /* Blank
     * ,-----------------------------------------------------------------------------------------.
     * |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
     * |-----------------------------------------------------------------------------------------+
     * |        |     |     |     |     |     |     |     |     |     |     |     |     |        |
     * |-----------------------------------------------------------------------------------------+
     * |         |     |     |     |     |     |     |     |     |     |     |     |             |
     * |-----------------------------------------------------------------------------------------+
     * |           |     |     |     |     |     |     |     |     |     |           |     |     |
     * |-----------------------------------------------------------------------------------------+
     * |     |     |     |                 |        |              |     |     |     |     |     |
     * `-----------------------------------------------------------------------------------------'
     */
    const uint16_t PROGMEM keymaps[][ MATRIX_ROWS ][ MATRIX_COLS ] = {
        /* Qwerty
         * ,-----------------------------------------------------------------------------------------.
         * |  ~  |  1  |  2  |  3  |  4  |  5  |  6  |  7  |  8  |  9  |  0  |  -  |  =  | bks | del |
         * |-----------------------------------------------------------------------------------------+
         * | Tab    |  Q  |  W  |  E  |  R  |  T  |  Y  |  U  |  I  |  O  |  P  |  [  |  ]  |    \   |
         * |-----------------------------------------------------------------------------------------+
         * | Caps    |  A  |  S  |  D  |  F  |  G  |  H  |  J  |  K  |  L  |  ;  |  '  |    Enter    |
         * |-----------------------------------------------------------------------------------------+
         * | Shift     |  Z  |  X  |  C  |  V  |  B  |  N  |  M  |  ,  |  .  |    shft   | up  | rgb |
         * |-----------------------------------------------------------------------------------------+
         * | ctl | sup | alt |    backspace    |  esc   |     space    | ctl | mo5 | lft | dwn | rht |
         * `-----------------------------------------------------------------------------------------'
         */
        KEYMAP(
            KC_GRV , KC_1   , KC_2   , KC_3   , KC_4   , KC_5   , KC_6   , KC_7   , KC_8   , KC_9   , KC_0   , KC_MINS, KC_EQL , KC_BSPC, KC_DEL ,
            TAB    , KC_Q   , KC_W   , KC_E   , KC_R   , KC_T   , KC_Y   , KC_U   , KC_I   , KC_O   , KC_P   , KC_LBRC, KC_RBRC, KC_BSLS,
            CAPS   , KC_A   , KC_S   , KC_D   , KC_F   , KC_G   , KC_H   , KC_J   , KC_K   , KC_L   , KC_SCLN, KC_QUOT, KC_ENT ,
            LSHFT  , KC_Z   , KC_X   , KC_C   , KC_V   , KC_B   , KC_N   , KC_M   , KC_COMM, KC_DOT , RSHFT  , KC_UP  , RGB_TOG,
            KC_LCTL, KC_LGUI, KC_LALT, LTSPC  , MDSPC  , RTSPC  , KC_RCTL, MO( 5 ), KC_LEFT, KC_DOWN, KC_RIGHT ),

        /* Left Space
         * ,-----------------------------------------------------------------------------------------.
         * | esc | f1  | f2  | f3  | f4  | f5  | f6  | f7  | f8  | f9  | f10 | f11 | f12 |     |     |
         * |-----------------------------------------------------------------------------------------+
         * | c_tab  | esc | c_w |cs_tb|c_tab| c_t |  (  |  7  |  8  |  9  |  )  |  ^  |     |        |
         * |-----------------------------------------------------------------------------------------+
         * |         | c_a |     |     | c_f |     |  *  |  4  |  5  |  6  |  +  |  =  |             |
         * |-----------------------------------------------------------------------------------------+
         * |           | c_z | c_x | c_c | c_v | c_b |  /  |  1  |  2  |  3  |     -     |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |     |     |     |                 |  space |       0      |     |     |     |     |     |
         * `-----------------------------------------------------------------------------------------'
         */

             #define C_TAB LCTL( KC_TAB )
             #define C_W LCTL( KC_W )
             #define CS_TAB LCTL( LSFT( KC_TAB ) )
             #define C_A LCTL( KC_A )
             #define C_B LCTL( KC_B )
             #define C_C LCTL( KC_C )
             #define C_F LCTL( KC_F )
             #define C_S LCTL( KC_S )
             #define C_T LCTL( KC_T )
             #define C_V LCTL( KC_V )
             #define C_X LCTL( KC_X )
             #define C_Z LCTL( KC_Z )

        KEYMAP(
            KC_ESC , KC_F1  , KC_F2  , KC_F3  , KC_F4  , KC_F5  , KC_F6  , KC_F7  , KC_F8  , KC_F9  , KC_F10  , KC_F11 , KC_F12 , _______, _______,
            C_TAB  , KC_ESC , C_W    , CS_TAB , C_TAB  , C_T    , KC_LPRN, KC_7   , KC_8   , KC_9   , KC_RPRN , KC_CIRC, _______, _______,
            _______, C_A    , C_S    , _______, C_F    , _______, KC_PAST, KC_4   , KC_5   , KC_6   , KC_PPLS , KC_EQL , _______,
            _______, C_Z    , C_X    , C_C    , C_V    , C_B    , KC_PSLS, KC_1   , KC_2   , KC_3   , KC_PMNS , _______, _______,
            _______, _______, _______, _______, KC_SPC , KC_0   , _______, _______, _______, _______, _______),

        /* Middle Space
         * ,-----------------------------------------------------------------------------------------.
         * |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |        |     |     |     |     |     |     | pscr| nlck| slck| brk |     |     |        |
         * |-----------------------------------------------------------------------------------------+
         * |         |     |     |     |     |     |     | rwd | ff  | ply | stp |     |             |
         * |-----------------------------------------------------------------------------------------+
         * |           |     |     |     |     |     |     | volu| vold| mut |           |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |     |     |     |                 |        |              |     |     |     |     |     |
         * `-----------------------------------------------------------------------------------------'
         */
        KEYMAP(
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_PSCR, KC_NLCK, KC_SLCK, KC_PAUS, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_MRWD, KC_MFFD, KC_MPLY, KC_MSTP, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_VOLD, KC_VOLU, KC_MUTE, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______),

        /* Right Space
         * ,-----------------------------------------------------------------------------------------.
         * | rst |     |     |     |     |     |     |     |     |     |     |     |     |     | slp |
         * |-----------------------------------------------------------------------------------------+
         * |        |     | hud | hui | sld |     |     |     |     |     |     |     |     |        |
         * |-----------------------------------------------------------------------------------------+
         * |         |     | vld | vlu | mod |     | lft | dwn | up  | rht |     |     |             |
         * |-----------------------------------------------------------------------------------------+
         * |           |     | sad | sai | rgb |     |     |     |     |     |           |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |     |     |     |                 |        |              |     |     |     |     |     |
         * `-----------------------------------------------------------------------------------------'
         */

             #define SLDRGB F( SOLID_RGB )

        KEYMAP(
            RESET  , _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, KC_SLEP,
            _______, _______, RGB_HUD, RGB_HUI, SLDRGB , _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, RGB_VAD, RGB_VAI, RGB_MOD, _______, KC_LEFT, KC_DOWN, KC_UP  , KC_RGHT, _______, _______, _______,
            _______, _______, RGB_SAD, RGB_SAI, RGB_TOG, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______),

        /* Numeric Symbols
         * ,-----------------------------------------------------------------------------------------.
         * |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |        |     |     |     |     |     |     |  &  |  *  |  (  |     |     |     |        |
         * |-----------------------------------------------------------------------------------------+
         * |         |     |     |     |     |     |     |  $  |  %  |  ^  |     |     |             |
         * |-----------------------------------------------------------------------------------------+
         * |           |     |     |     |     |     |     |  !  |  @  |  #  |           |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |     |     |     |                 |        |      )       |     |     |     |     |     |
         * `-----------------------------------------------------------------------------------------'
         */
        KEYMAP(
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_AMPR, KC_ASTR, KC_LPRN, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_DLR , KC_PERC, KC_CIRC, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, KC_EXLM, KC_AT  , KC_HASH, _______, _______, _______,
            _______, _______, _______, _______, _______, KC_RPRN, _______, _______, _______, _______, _______),

        /* PGUP/DOWN HOME/END
         * ,-----------------------------------------------------------------------------------------.
         * |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
         * |-----------------------------------------------------------------------------------------+
         * |        |     |     |     |     |     |     |     |     |     |     |     |     |        |
         * |-----------------------------------------------------------------------------------------+
         * |         |     |     |     |     |     |     |     |     |     |     |     |             |
         * |-----------------------------------------------------------------------------------------+
         * |           |     |     |     |     |     |     |     |     |     |           | pgu |     |
         * |-----------------------------------------------------------------------------------------+
         * |     |     |     |                 |        |              |     |     | hme | pgd | end |
         * `-----------------------------------------------------------------------------------------'
         */
        KEYMAP(
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, _______, KC_PGUP, _______, _______, _______,
            _______, _______, _______, _______, _______, _______, _______, _______, KC_HOME, KC_PGDN, KC_END),

    };
